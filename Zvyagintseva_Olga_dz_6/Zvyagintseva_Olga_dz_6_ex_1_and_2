# """Задание 1.
# По ТЗ необходимо создать список кортежей"""
# with open("nginx_logs.txt", "r", encoding="utf-8") as f:
#     result_list = []
#     for line in f:
#         request = line.split('"')[1]
#         result_list.append((line.split()[0], request.split()[0], request.split()[1]))
#
#
# """Обратила внимание, что невозможно вывести на экран весь список, т.к. объем данных слишком большой"""
# print(result_list)
#
# """Поэтому вторую часть задания делала по другой тактике, т.к. обязательным условием было - работоспособность кода,
# когда объем данных превышает ОЗУ""" 

"""Задание 1.
Создаю отдельный файл с логами, где хранятся все ip, типы запроса и ресурсы"""

with open("nginx_logs.txt", "r", encoding="utf-8") as f:
    with open("log.txt", 'w+', encoding='utf-8') as a:
        for line in f:
            request = line.split('"')[1]
            result = (line.split()[0], request.split()[0], request.split()[1])
            a.write(' '.join(result) + "\n")


"""Задание 2. 
Используя полученные логи - необходимо найти спамера и кол-во отправленных им запросов"""
with open("log.txt", 'r', encoding='utf-8') as d:
    spam_dict = {}
    for line in d:
        spam_dict.setdefault(line.split()[0], 0)
        spam_dict[line.split()[0]] += 1

spammer = max(spam_dict.items(), key=lambda x: x[1])
print(spammer)
